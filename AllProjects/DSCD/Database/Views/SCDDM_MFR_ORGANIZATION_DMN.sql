CREATE OR REPLACE VIEW SCD.SCDDM_MFR_ORGANIZATION_DMN AS
SELECT   /*+ NO_MERGE */
  organization_key_id,
  effective_from_dt,
  effective_to_dt,
  organization_id,
  organization_alternate_nm,
  organization_abbreviated_nm,
  organization_short_nm,
  organization_long_nm,
  parent_organization_id,
  parent_organization_nm,
  organization_hyperion_cde,
  organization_hyperion_desc,
  organization_status_cde,
  organization_status_desc,
  organization_level_cde,
  organization_type_desc,
  company_organization_id,
  company_organization_nm,
  region_organization_id,
  region_organization_nm,
  iso_country_cde,
  iso_country_intl_dial_from_cde,
--  iso_country_intl_dial_to_cde,
  iso_country_nm,
  iso_legacy_preferred_org_cde,
  layer1_organization_id,
  layer1_organization_cde,
  layer1_organization_type_desc,
  layer1_organization_short_nm,
  layer1_org_hyperion_cde,
  layer1_org_hyperion_desc,
  layer1_org_status_cde,
  layer1_org_status_desc,
  layer1_organization_level_cde,
  layer2_organization_id,
  layer2_organization_cde,
  layer2_organization_type_desc,
  layer2_organization_short_nm,
  layer2_org_hyperion_cde,
  layer2_org_hyperion_desc,
  layer2_org_status_cde,
  layer2_org_status_desc,
  layer2_organization_level_cde,
  layer3_organization_id,
  layer3_organization_cde,
  layer3_organization_type_desc,
  layer3_organization_short_nm,
  layer3_org_hyperion_cde,
  layer3_org_hyperion_desc,
  layer3_org_status_cde,
  layer3_org_status_desc,
  layer3_organization_level_cde,
  layer4_organization_id,
  layer4_organization_cde,
  layer4_organization_type_desc,
  layer4_organization_short_nm,
  layer4_org_hyperion_cde,
  layer4_org_hyperion_desc,
  layer4_org_status_cde,
  layer4_org_status_desc,
  layer4_organization_level_cde,
  layer5_organization_id,
  layer5_organization_cde,
  layer5_organization_type_desc,
  layer5_organization_short_nm,
  layer5_org_hyperion_cde,
  layer5_org_hyperion_desc,
  layer5_org_status_cde,
  layer5_org_status_desc,
  layer5_organization_level_cde,
  layer6_organization_id,
  layer6_organization_cde,
  layer6_organization_type_desc,
  layer6_organization_short_nm,
  layer6_org_hyperion_cde,
  layer6_org_hyperion_desc,
  layer6_org_status_cde,
  layer6_org_status_desc,
  layer6_organization_level_cde,
  layer7_organization_id,
  layer7_organization_cde,
  layer7_organization_type_desc,
  layer7_organization_short_nm,
  layer7_org_hyperion_cde,
  layer7_org_hyperion_desc,
  layer7_org_status_cde,
  layer7_org_status_desc,
  layer7_organization_level_cde,
  layer8_organization_id,
  layer8_organization_cde,
  layer8_organization_type_desc,
  layer8_organization_short_nm,
  layer8_org_hyperion_cde,
  layer8_org_hyperion_desc,
  layer8_org_status_cde,
  layer8_org_status_desc,
  layer8_organization_level_cde,
  layer9_organization_id,
  layer9_organization_cde,
  layer9_organization_type_desc,
  layer9_organization_short_nm,
  layer9_org_hyperion_cde,
  layer9_org_hyperion_desc,
  layer9_org_status_cde,
  layer9_org_status_desc,
  layer9_organization_level_cde,
  layer10_organization_id,
  layer10_organization_cde,
  layer10_organization_type_desc,
  layer10_organization_short_nm,
  layer10_org_hyperion_cde,
  layer10_org_hyperion_desc,
  layer10_org_status_cde,
  layer10_org_status_desc,
  layer10_organization_level_cde,
  record_status_cde,
  dml_ts,
  dml_user_id,
  func_rept_iso_currency_cde,
  data_provider_ind
FROM
  MASTER.ORGANIZATIONS_DMN org
WHERE
  org.effective_to_dt = (select max(sub.effective_to_dt)
			from master.organizations_dmn sub
			where sub.organization_key_id=org.organization_key_id)
;
